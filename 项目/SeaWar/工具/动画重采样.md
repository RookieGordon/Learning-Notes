---
tags:
  - SeaWar/工具/动画重采样
  - mytodo
  - Unity/Tools/动画采样
type: Project
project: SeaWar
projectType: Task
fileDirPath: 项目/SeaWar/工具
dateStart: 2025-06-17
dateFinish: 2025-06-21
finished: false
displayIcon: pixel-banner-images/项目任务.png
---
# 需求背景
项目中，存在一个超大的动画，时长达到1min，并且是60FPS。项目本身是一个SLG类型项目，本就不需要使用60FPS这么高精度的动画。
因此，需要做一个工具，批量将项目中的60FPS动画重新采样成30FPS动画。
## 60FPS动画的影响
### **导入与工作流注意事项**
- **重采样风险**：  
    若原始动画非60FPS（如电影标准的24FPS），Unity导入时自动重采样可能引入**冗余关键帧**或**数据失真**
    **解决方法**：在导入设置中勾选 `Resample Curves` 并匹配原始帧率。Assets > Model File > Animation > Resample Curves (启用)
### **与游戏帧率的关系**
- **独立于游戏FPS**：  
    Unity动画系统基于时间而非帧更新，即使游戏运行帧率低于60FPS，60FPS动画仍能通过插值保持平滑（但无法超越游戏实际帧率）
### **最佳实践建议**
1. **按需分配帧率**：  
    关键动画（战斗/过场）用60FPS，次要动画（环境交互）用30FPS。
2. **压缩动画数据**：  
    启用动画压缩减少体积（`Animation Clip > Compression > Optimal`），注意测试是否影响精度。
3. **烘焙物理动画**：  
    对物理模拟动画（如布料），60FPS可提升真实感，但优先考虑使用`Unity.Animations.Rigging`实时驱动。
4. **测试多平台**：  
    在目标设备上Profile性能：`Window > Analysis > Profiler` 查看 `Animation.Update` 耗时。
# 需求与解决方案
## 需求
将60FPS的动画，重新采样成30FPS的动画，尽量保证动画的效果不变，压缩数据量。
## 直接修改Samples的方案
在Animation窗口中，有帧率显示，并且可以修改，但其实，只是将动画按照设定帧率进行播放。
![[（图解1）SampleRate=30.gif|420]]
![[（图解2）SampleRate=15.gif|420]]
结合Animation Window展示的时长对比，低帧率的动画时长比原先的长了一倍。
![[（图解3）不同帧率动画的时长对比.png|530]]
>[!IMPORTANT]
>`Animation`窗口的`Samples`属性，能修改帧率，但同时，也会修改整个动画的时长。具体说，高帧率改低帧率，时长增加，播放变慢。低帧率改高帧率，时间减少，播放变快。保持总帧数不变。
## 解决方案
### 思路
因为30帧的关键帧间隔是60帧的两倍。因此，如果60帧动画的关键帧是均匀分布的，那么直接取30帧关键帧对应的3个60帧关键帧的均值即可：
![[（图解4）帧动画时间轴.png|550]]
但是实际上，原始动画的关键帧并不是均匀的。所以具体思路如下：
取30FPS的任意关键帧，
1. 如果是奇数帧，并且对应60FPS在该时间点有关键帧，那就使用，否则该时间点就没有关键帧；
2. 如果是偶数帧，那么就比较复杂，其对应的三个关键帧可能出现多种情况情况，为了方便讨论，标记60FPS对应时间点的三个关键帧为A、B、C
	- 三个帧都有，和只有A、C的情况一致，取平均值即可；
	- 只有A、B或只有B、C，通过斜率，计算值；
	- 只有一个帧的时候，就需要引入额外新的帧数据（前一个或后一个）计算斜率







