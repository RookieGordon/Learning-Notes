---
tags:
  - 字典树
  - 敏感词检查
---

```cardlink
url: https://www.cnblogs.com/ljy-endl/p/11530976.html
title: "Trie字典树（超详细！！！） - endl\\n - 博客园"
description: "介绍 字典树，也称Trie、字母树，指的是某个字符串集合对应的形如下图的有根树。树的每条边上对应有恰好一个字符，每个顶点代表从根到该节点的路径所对应的字符串（将所有经过的边上的字符按顺序连接起来）。有时我们也称Trie上的边为转移，顶点为状态。 流程 初始化 一棵空Trie仅包含一个根节点，该点的字"
host: www.cnblogs.com
favicon: https://assets.cnblogs.com/favicon_v3_2.ico
```

选择 **AC自动机(Aho-Corasick Automaton)**，它是一种高效处理多模式字符串匹配问题的数据结构。它在构建敏感词多模匹配规则时性能非常高，非常适合你的需求。

本文将详细说明如何实现上述需求，并提供 C# 的完整实现代码。

---

### 核心思路

1. **构建 AC 自动机：**
    
    - AC自动机结合了**Trie树**（前缀树）和 **KMP算法** 的思想，可以处理多模式匹配问题。
    - 首先将所有敏感词 (`l`) 构建成一个 Trie 树。
    - 构建失败指针（Failure Pointers），以快速跳转到下一个模式，提升性能。
2. **匹配字符串并替换：**
    
    - 利用 AC 自动机在输入字符串中高效匹配所有敏感词。
    - 将找到的敏感词在输入字符串中替换为 `*`。
  ### 代码说明

1. **`AddPattern` 方法：**
    
    - 将敏感词插入到前缀树中，构建基础的 Trie 树结构。
2. **`BuildFailurePointers` 方法：**
    
    - 使用 BFS 构建失败指针，这可以优化在搜索过程中跳到下一个匹配模式。
3. **`ReplaceSensitiveWords` 方法：**
    
    - 遍历输入字符串 `input`，利用 AC 自动机匹配敏感词。
    - 如果匹配上敏感词，记录其位置并用 `*` 替换敏感词字符。
4. **耗时分析**：
    
    - **构建阶段**：`O(n)`（其中 `n` 是敏感词长度的总和）。
    - **匹配阶段**：`O(m)`（其中 `m` 是输入字符串的长度）。
    - 总时间复杂度为 **线性时间复杂度 O(n + m)**。