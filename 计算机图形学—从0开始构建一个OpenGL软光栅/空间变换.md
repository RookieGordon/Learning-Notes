---
tags:
  - 图形学
  - 软光栅
---
# 二维空间变换
## 二维旋转

![[（图解16）二维逆时针旋转操作.png|433]]

二维逆时针旋转矩阵：
$$\begin{align}
R_{\theta} & = \begin{bmatrix}  
  \cos \theta  & -\sin \theta \\  
  \sin \theta  & \cos \theta
\end{bmatrix} 
\end{align}$$

## 二维平移矩阵
![[（图解17）二维平移操作.png|497]]

### 齐次坐标

为了迎合平移变换，且能相乘的形式。我们为每一个顶点或向量坐标加一个维度，让二维向量升为三维向量。如果是点的形式，就补一个1，如果是向量，就补一个0。
![[（图解18）点和向量的齐次坐标.png]]
因为向量是位置信息的，所以补一个0后，用平移矩阵对一个向量做平移操作，结果不变。但是一个点再经过平移操作后，位置会发生变化，这样就要求补一个1。

二维平移矩阵：
$$\begin{align}
T & = \begin{bmatrix}  
  1  & 0 & t_{x} \\
  0  & 1 & t_{y} \\
  0  & 0 & 1 \\
\end{bmatrix} 
\end{align}$$

# 三维空间变换

三维坐标系的基向量(X/Y/Z)根据排列不同，分为左手坐标系与右手坐标系。
![[（图解19）左手和右手坐标系.png|564]]
右手坐标系满足叉乘的右手规则。

## 三维旋转操作

三维空间操作中的平移和缩放操作，都可以直接在二维的基础上进行升维类比。

三维空间中的旋转是围绕一个旋转中心轴。对于绕某个轴旋转$\theta$角，是指逆着当前轴（从正方向）看过去，逆时针旋转旋转$\theta$角。

绕z轴逆时针旋转矩阵为：
$$\begin{array}{c}
R_{\theta} = \begin{bmatrix}  
  \cos \theta  & -\sin \theta  & 0 & 0 \\  
  \sin \theta  & \cos \theta   & 0 & 0 \\  
    0          &   0           & 1 & 0 \\
    0          &   0           & 0 & 1
\end{bmatrix} 
\end{array}$$

绕x轴逆时针旋转矩阵为：
$$\begin{array}{c}
R_{\theta} = \begin{bmatrix}  
    1          &   0           & 0 & 0 \\
  \cos \theta  & -\sin \theta  & 0 & 0 \\  
  \sin \theta  & \cos \theta   & 1 & 0 \\  
    0          &   0           & 0 & 1 \\
\end{bmatrix} 
\end{array}$$

绕y轴逆时针旋转矩阵为：
$$\begin{array}{c}
R_{\theta} = \begin{bmatrix}  
  \cos \theta  & \sin \theta   & 0 & 0 \\  
    0          &   1           & 0 & 0 \\
  -\sin \theta & \cos \theta   & 1 & 0 \\  
    0          &   0           & 0 & 1 \\
\end{bmatrix} 
\end{array}$$
 
### 三维空间旋转任意轴的旋转矩阵

如果将点看成是单位向量的缩放结果，那么旋转操作的几何意义就是坐标系的旋转。

已知旋转轴为u轴，v绕其旋转$\theta$角，得到$v'$，求$v'$的坐标：
![[（图解20）任意轴旋转推导过程1.png|405]]

**<font color="#ffff00">求解思路：</font>**
![[（图解21）求旋转矩阵的一组基向量.png|566]]

根据向量点乘的几何意义有：
$$\begin{align}
\vec{v_{\parallel}} & = (\vec{v}\cdot \vec{u})\cdot \vec{u}\\
\vec{v_{\perp}} & = \vec{v} - \vec{v_{\parallel}}
\end{align}$$

从$u$轴正方向看过去（顶部俯视图），求$\vec{v'_{\perp}}$还需要构造纵坐标向量$\vec{w}$。
![[（图解22）任意轴旋转推导过程2.png|477]]

根据$\vec{v'_{\perp}}$产生的方向，可以得到$\vec{w}$的方向就是$\vec{u} \times\vec{v_{\perp}}$。再根据三角形可以得到：
$$\vec{v'_{\perp}} = \cos \theta \vec{v_{\perp}} + \sin \theta(\vec{u} \times\vec{v_{\perp}})$$
将前面的公式带入，最终可得：
$$\vec{v'_{\perp}} = \cos \theta (\vec{v} - (\vec{v}\cdot \vec{u})\cdot \vec{u}) + \sin \theta(\vec{u} \times\vec{v}) + (\vec{v}\cdot \vec{u})\cdot\vec{u}$$

分别令$\vec{v}$等于(1,0,0)，(0,1,0)，(0,0,1)可以得到，旋转轴为u轴，v绕其旋转$\theta$角的旋转矩阵为：
![[（图解23）任意轴的旋转矩阵.png]]



# 视图变换

## 摄像机

摄像机的参数有：==位置，摄像机的观察方向，摄像机的正上方方向，摄像机视张角==。初始状态下，==摄像机位于原点，观察方向为负Z轴方向==。

### 摄像机的空间变换

摄像机的变换操作只有平移和旋转。最终变换矩阵$M = T*R$（==先平移再旋转==）。

> `由于摄像机的空间变换的复杂性，以及投影需求的不变性。考虑将目标物体和摄像机同时逆变换到摄像机的初始状态，可以大大降低投影的复杂度，并且由于物体与摄像机的相对位置不变，投影的结果也是不变的。`

### 摄像机逆变换矩阵

已知摄像机当前的观察方向向量$front$（归一化向量）和位置p
![[（图解24）摄像机逆变换矩阵.png|578]]

由任意轴旋转矩阵可得，xyz坐标系旋转变换到了ru-f坐标系。在已知摄像机正上方和观察方向时，可以通过两者叉乘得到r向量，进而得到u向量，所以有，摄像机的旋转矩阵为：
![[（图解25）摄像机的旋转矩阵和逆矩阵.png|598]]
摄像机的平移矩阵为：
![[（图解26）摄像机的平移矩阵和逆矩阵.png|608]]

### 摄像机视图变换矩阵（View Matrix）

View Matrix即摄像机变换到目标状态的逆矩阵，作用是将摄像机变换回到初始状态。
![[（图解27）摄像机空间变换矩阵.png|621]]

![[（图解28）摄像机的视图变换矩阵.png|689]]

# 投影变换

## 正交投影变换

### 正交投影盒空间和正交投影平面

正交投影盒空间是指，定义一个立方体，只有在立方体内的物体才会“可视”，其他的都看不到；即在视图变换后的结果中，选择一块区域进行渲染显示。

投影平面唯一投影盒正Z轴方向的面：
![[（图解31）正交投影平面与屏幕.png|546]]

有了正交投影盒空间
## 透视投影变换
