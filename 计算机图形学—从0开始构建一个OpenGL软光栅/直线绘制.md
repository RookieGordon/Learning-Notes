---
tags:
  - 图形学
  - 软光栅
---
# Windows窗体

## Windows API

windows API一般采用句柄（Handle）来进行资源操作。
- 句柄（Handle）是一个是用来标识对象或者项目的标识符，可以用来描述窗体、文件等
- 句柄通常可以是一个整数或者一个指针类型
- 句柄所指代的资源通常不能直接访问
- 句柄通常会作为AP的参数，通过AP函数来改变句柄指代资源的状态

- ## Windows入口函数

Windowsi窗口程序需要满足如下特点：
- 使用wWinMain作为程序入口点，而不是main函数
- 使用#pragma comment的linker选项，选择入口点，并且决定是否启用console
- 选项
	- entry（mainCRTStartup/wWinMainCRTStartup），用于控制人口函数是main还是wWinMain。
	- subsystem:console/windows，console表示，创建一个窗口，并且可以使用命令

```Cpp
#include <Windows.h>

#pragma comment(linker, "/subsystem:console /entry:wWinMainCRTStartup" )

/* 1、主循环流程在winMain函数中
 * 2、窗体构建，消息处理，其他方面的细节都封装在application类里面
 */
int APIENTRY wWinMain(
	_In_ HINSTANCE hInstance,		//本应用程序实例句柄，唯一指代当前程序
	_In_opt_ HINSTANCE hPrevInstance,	//本程序前一个实例，一般是null
	_In_ LPWSTR    lpCmdLine,		//应用程序运行参数
	_In_ int       nCmdShow)		//窗口如何显示（最大化、最小化、隐藏），不需理会
{
	if (!app->initApplication(hInstance,800, 600)) {
		return -1;
	}

	bool alive = true;
	while (alive) {
		alive = app->peekMessage();
	}

	return 0;
}
```

## Windows窗体

Windows下创建窗体，首先应该创建一个WINDCLASSEXW，即窗体的类型描述模板，通常在模板里面，设置窗口大小，窗口重绘事件，图标，背景色，标题等等属性。

### 创建窗口并显示

通过CreateWindowW函数来创建窗口：
```Cpp
mHwnd = CreateWindowW( mWindowClassName,
        (LPCWSTR)"GraphicLearning", //窗体标题
        dwStyle,
        500,//x位置，相对左上角
        500,//y位置，相对左上角
        windowRect.right - windowRect.left,
        windowRect.bottom - windowRect.top,
        nullptr,//父窗体
        nullptr,//菜单栏
        hInstance,//程序实例，由wWinMain入口函数传入
        nullptr);//额外参数
```
该函数返回一个窗体的句柄。windowRect是控制窗体大小的结构体。