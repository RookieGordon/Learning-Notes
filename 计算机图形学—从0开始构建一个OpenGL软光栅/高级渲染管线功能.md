---
tags:
  - 图形学
  - 软光栅
---
# 裁剪

## 直线方程的向量理解

将直线方程$y = kx + b$转换成$\vec{n} * \vec{p} = d$，其中$\vec{p} = (x, y)$。$d$为常数，等于原点到直线的距离。$\vec{n}$向量为单位向量，垂直于直线，指向直线。
![[（图解66）直线的向量理解.png|356]]

这样，可以将直线方程理解成，p点是所有满足向$\vec{n}$投影长度为d的点的集合。

## 直线方程的距离理解

直线表达式中的d发生变化的时候，意味着直线沿着法线$\vec{n}$滑动

## 点与直线的距离关系

空间中任一点q，带入到直线方程，得到的结果都是q在$\vec{n}$上的投影。当$\vec{n} * \vec{q} - d > 0$，表示q在法线一侧，即正面，反正在背面。
![[（图解67）点与直线的距离关系.png|372]]

## 平面方程

空间中一平面，使用法线方式表达如下：$ax + by + cz = d$。同样可以令$\vec{n} = [a, b, c]$，则可以写成$\vec{n} * \vec{p} = d$的形式。 
![[（图解68）空间中平面的向量理解.png|347]]
所以，一个平面表示，p点是所有满足向$\vec{n}$投影长度为d的点的集合。

因此，类比于直线方程，有当$\vec{n} * \vec{q} - d > 0$，表示q在平面法线一侧，即正面，反正在背面。

## 多边形剪裁算法——Sutherland-Hodgman算法（逐边裁剪法）

SH算法采用了分割处理，逐边裁剪的方法。

二维空间中，算法思想如下：
- 一次用窗口的一条边裁剪多边形，循环多次
- 每次，构造一个空的点数组DST；原数组为SRC
- 每次，所有顶点从0号开始，作为S点，S后面的点为P点，依次进行测试，结果输出点到DST，剪裁原则如下图
- SRC=DST
![[（图解69）逐边裁剪算法两个顶点的不同测试情况.png]]

举例如下：
![[（图解70）考察上边界，裁剪三角形.png|529]]
![[（图解71）考察右边界裁剪四边形.png|530]]
裁剪完成后，输出了一个四边形，这时候，就需要进行三角形重建，将四边形拆分成两个三角形。拆分思路如下：`永远以数组的第一个顶点为起始点，递进构建三角形`
![[（图解72）四边形拆分成三角形.png|348]]
这样，1-1'-2’'-0这个四边形就被拆分成了1-1‘-2‘’和1-2‘’-0这两个三角形。
# 透视修正