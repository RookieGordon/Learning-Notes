---
tags:
  - Cpp
---

> [!INFO]
> [作用域、链接属性和存储类型 - 扶磐 - 博客园 (cnblogs.com)](https://www.cnblogs.com/codefuturedalao/p/14400825.html)


变量的作用域指能够访问该变量的范围。但是当一个项目由多个文件构成时候，变量的作用域也会收到影响。

## 存储类

每个变量都有一个存储类，它决定着程序将把变量的值存储在计管机上的什么地方、如何存储以及变量应该有着怎样的作用域。

默认的存储类是<font color="#00b050">**auto**</font>。自动变量存储在称为栈（stack）的临时内存里并有着最小小的作用域。当程序执行到语句块或函数末尾的时，它们将被系统回收（栈回收），不复存在。

与auto不同的是<font color="#ffff00">**static**</font>，static变量在程序的生命期内将一直保有它的值而不会消亡。因为它们是存储在静态存储区，生命周期为从中请到程序退出（和全局变量一样)。

第三种存储类是<font color="#00b0f0">**extern**</font>，它在有多个翻译单元时非常重要。这个关键字用来把另一个翻译单元里的某个变量声明为本翻译单元里的一个同名全局变量。编译器不会为extern变量分配内存，因为已经在其他地方分配过了。

<font color="#ffc000">**register**</font>存储类要求编译器将一个变量存储在CPU的寄存器里面，其有着与自动变量相同的作用域。register变量的存储速度是最快的，但是有些编译器可能不允许使用这类变量。

## 链接

> [!INFO]
> [程序详细编译过程（预处理、编译、汇编、链接） - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/476697014)

编译过程分为四个阶段：**预处理（Preprocessing）、编译（Compilation）、汇编（Assembly）、链接（Linking）**。执行这四个阶段的程序（**预处理器、编译器、汇编器、和链接器**）一起构成了编译系统。


![](https://pic3.zhimg.com/80/v2-b9e8babf753b1691039458592667121a_1440w.webp)

预处理：处理代码中的预处理指令。例如预处理器会将所有的#define删除，并且展开所有的宏定义。

编译：将预处理完的文本文件hello.i进行一系列的词法分析、语法分析、语义分析和优化，翻译成文本文件hello.s，它包含一个汇编语言程序。

汇编：汇编器（as）将hello.s翻译成机器语言指令，把这些指令打包成一种叫做**可重定位目标程序**的格式，并将结果保存在目标文件hello.o中，hello.o是一个二进制文件。

链接（Linkage）： 指的是标识符在不同编译单元之间的可见性和连接方式。在C++中，有三种主要的链接类型：

- 外部链接（External Linkage）：全局变量和非静态函数具有外部链接，它们可以在不同的源文件之间共享。在一个源文件中定义一个全局变量或非静态函数，可以在其他源文件中通过声明同名的变量或函数来访问。普通函数、变量、模板和命名空间都有外链接。
- 内部链接（Internal Linkage）：在一个源文件内部使用 static 关键字声明的变量具有内部链接，这些变量只能在同一个源文件的其他函数中访问。
- 无链接（No Linkage）：局部变量和函数参数具有无链接，它们只能在声明它们的函数内部访问。

## 使用CMake编译项目

>[!INFO]
>[教程 — CMake 3.26.4 Documentation (cmake-doc.readthedocs.io)](https://cmake-doc.readthedocs.io/zh-cn/latest/guide/tutorial/index.html)

>[!INFO]
>[全网最细的CMake教程！(强烈建议收藏) - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/534439206)

>[!INFO]
>[CMake命令](https://cmake.org/cmake/help/latest/manual/cmake-commands.7.html)
### 基本项目
CMakeLists.txt是整个CMake工程的描述文件。
``` CMake
#需求最低的cmake程序版本
cmake_minimum_required(VERSION 3.12)

#工程名称
project(Graphic)

#工程的C++版本
set(CMAKE_CXX_STANDARD 17)

#本工程主文件编译编译链接，生产exe
add_executable(softRenderer, "main.cpp")
```

- [`cmake_minimum_required()`](https://cmake-doc.readthedocs.io/zh-cn/latest/command/cmake_minimum_required.html#command:cmake_minimum_required "cmake_minimum_required") 命令指定最低 CMake 版本，必须位于CMakeList文件第一行。

- `set(<variable> <value>... [PARENT_SCOPE])` 此命令的签名指定一个 `<value>...` 占位符期望零个或多个参数。多个参数将作为分号分隔的列表 <CMake Language Lists> 连接起来，以形成要设置的实际变量值。零参数将导致普通变量被取消设置。请参阅 [`unset()`](https://cmake-doc.readthedocs.io/zh-cn/latest/command/unset.html#command:unset "unset") 命令显式取消设置变量。


- [`CMAKE_CXX_STANDARD`](https://cmake-doc.readthedocs.io/zh-cn/latest/variable/CMAKE_CXX_STANDARD.html#variable:CMAKE_CXX_STANDARD "CMAKE_CXX_STANDARD") 和 [`CMAKE_CXX_STANDARD_REQUIRED`](https://cmake-doc.readthedocs.io/zh-cn/latest/variable/CMAKE_CXX_STANDARD_REQUIRED.html#variable:CMAKE_CXX_STANDARD_REQUIRED "CMAKE_CXX_STANDARD_REQUIRED")这两个特殊的变量，可以一起使用来指定构建项目所需的 C++ 标准。

### 多文件项目

```CMake
#需求最低的cmake程序版本
cmake_minimum_required(VERSION 3.12)

#工程名称
project(Graphic)

#工程的C++版本
set(CMAKE_CXX_STANDARD 17)

#搜索所有的*.cpp文件，加入SRCS变量中
aux_source_directory(. SRCS)

#本工程所有cpp文件编译编译链接，生产exe
add_executable(softRenderer, ${SRCS})
```

`aux_source_directory(. SRCS)`用于遍历CMakeLists所在的当前文件夹下的所有*.cpp文件，将其放入变量**`SRCS`**中，最后，再用这些文件来编译构建softRenderer.exe文件。

### 多文件夹编译




