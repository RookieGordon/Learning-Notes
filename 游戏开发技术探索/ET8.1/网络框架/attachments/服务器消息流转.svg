<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than draw.io -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background: transparent; background-color: transparent; color-scheme: light dark;" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2577px" height="2771px" viewBox="0 0 2577 2771" content="&lt;mxfile host=&quot;app.diagrams.net&quot; agent=&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36&quot; version=&quot;29.4.0&quot;&gt;&#10;  &lt;diagram name=&quot;服务器消息收发&quot; id=&quot;server-msg-flow&quot;&gt;&#10;    &lt;mxGraphModel dx=&quot;2880&quot; dy=&quot;1988&quot; grid=&quot;1&quot; gridSize=&quot;10&quot; guides=&quot;1&quot; tooltips=&quot;1&quot; connect=&quot;1&quot; arrows=&quot;1&quot; fold=&quot;1&quot; page=&quot;0&quot; pageScale=&quot;1&quot; pageWidth=&quot;3500&quot; pageHeight=&quot;2200&quot; math=&quot;0&quot; shadow=&quot;0&quot;&gt;&#10;      &lt;root&gt;&#10;        &lt;mxCell id=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;1&quot; parent=&quot;0&quot; /&gt;&#10;        &lt;mxCell id=&quot;bg_gate&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;opacity=30;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;1570&quot; width=&quot;1450&quot; x=&quot;10&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;lbl_gate&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;rounded=0;&quot; value=&quot;Gate Fiber&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;170&quot; x=&quot;630&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;bg_map&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;opacity=30;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;1570&quot; width=&quot;870&quot; x=&quot;1660&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;lbl_map&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=center;verticalAlign=middle;fontSize=24;fontStyle=1;rounded=0;&quot; value=&quot;Map Fiber&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;140&quot; x=&quot;2020&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;bg_mq&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;opacity=20;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;1570&quot; width=&quot;180&quot; x=&quot;1470&quot; y=&quot;30&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p1_head&quot; parent=&quot;1&quot; style=&quot;shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;50&quot; width=&quot;30&quot; x=&quot;65&quot; y=&quot;85&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p2&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=11;&quot; value=&quot;:NetComponent&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;160&quot; x=&quot;160&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p3&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=11;&quot; value=&quot;:Session&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;120&quot; x=&quot;360&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p4&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:NetComponentOnRead&amp;lt;br&amp;gt;Invoker_Gate&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;200&quot; x=&quot;510&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p5&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:MessageSession&amp;lt;br&amp;gt;Dispatcher&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;170&quot; x=&quot;740&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p6&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:MessageSession&amp;lt;br&amp;gt;Handler&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;170&quot; x=&quot;940&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p7&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:ProcessInnerSender&amp;lt;br&amp;gt;(Gate Fiber)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;180&quot; x=&quot;1140&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p8&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=11;fillColor=#dae8fc;strokeColor=#6c8ebf;&quot; value=&quot;:MessageQueue&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;150&quot; x=&quot;1480&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p9&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:ProcessInnerSender&amp;lt;br&amp;gt;(Map Fiber)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;180&quot; x=&quot;1680&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p10&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:MailBoxComponent&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;160&quot; x=&quot;1900&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p11&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:MessageDispatcher&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;160&quot; x=&quot;2100&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;p12&quot; parent=&quot;1&quot; style=&quot;rounded=0;whiteSpace=wrap;html=1;fontSize=10;&quot; value=&quot;:MessageHandler&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;160&quot; x=&quot;2300&quot; y=&quot;100&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll1&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;80&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;80&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll2&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll3&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll4&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll5&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;825&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;825&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll6&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1025&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1025&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll7&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1230&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1230&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll8&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1555&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1555&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll9&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1770&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1770&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll10&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1980&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1980&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll11&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;2180&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;2180&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;ll12&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=3 3;strokeWidth=1;strokeColor=#999999;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;2380&quot; y=&quot;140&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;2380&quot; y=&quot;1560&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg60&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;TCP/KCP 发送请求消息&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;80&quot; y=&quot;200&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;200&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg61&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;ReadCallback 反序列化消息&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;250&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;250&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg62&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;Invoke(SceneType.Gate, NetComponentOnRead)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;300&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;300&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;alt_frame&quot; parent=&quot;1&quot; style=&quot;shape=umlFrame;whiteSpace=wrap;html=1;width=50;height=25;fontSize=12;fontStyle=1;fillColor=none;pointerEvents=0;rounded=0;&quot; value=&quot;Alt&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;1180&quot; width=&quot;1990&quot; x=&quot;500&quot; y=&quot;340&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;guard1&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=left;fontSize=11;fontStyle=2;rounded=0;&quot; value=&quot;[ISessionMessage]&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;160&quot; x=&quot;560&quot; y=&quot;365&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;alt_sep&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=none;dashed=1;html=1;dashPattern=8 4;strokeWidth=1;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;500&quot; y=&quot;710&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;2490&quot; y=&quot;710&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;guard2&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=left;fontSize=11;fontStyle=2;rounded=0;&quot; value=&quot;[ILocationRequest]&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;170&quot; x=&quot;510&quot; y=&quot;718&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg63&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;Handle(session, message)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;410&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;825&quot; y=&quot;410&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg64&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;HandleAsync()&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;825&quot; y=&quot;460&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1025&quot; y=&quot;460&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg65&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=middle;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;align=left;&quot; value=&quot;Run(session, request, response)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;1120&quot; y=&quot;500&quot; /&gt;&#10;              &lt;mxPoint x=&quot;1120&quot; y=&quot;540&quot; /&gt;&#10;            &lt;/Array&gt;&#10;            &lt;mxPoint x=&quot;1025&quot; y=&quot;500&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1025&quot; y=&quot;540&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg66&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;session.Send(response)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1025&quot; y=&quot;590&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;590&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg67&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;序列化, AService.Send()&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;640&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;640&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg68&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=open;endFill=0;dashed=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;TCP/KCP 返回响应&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;680&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;80&quot; y=&quot;680&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg70&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;MessageLocationSender.Call()&amp;lt;br&amp;gt;→ MessageSender.Call()&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;804.17&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1230&quot; y=&quot;804.17&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;note70&quot; parent=&quot;1&quot; style=&quot;text;html=0;align=left;fontSize=9;fontStyle=2;fontColor=#888888;rounded=0;&quot; value=&quot;实际经过 MessageLocationSenderOneType&amp;#xa;→ MessageSender → ProcessInnerSender&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;25&quot; width=&quot;300&quot; x=&quot;830&quot; y=&quot;805&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg71&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;SendInner&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1230&quot; y=&quot;830&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1555&quot; y=&quot;830&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg72&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;取出消息列表&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1555&quot; y=&quot;880&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1770&quot; y=&quot;880&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg73&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;MailBoxComponent.Add(fromAddr, msg)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1770&quot; y=&quot;930&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1980&quot; y=&quot;930&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg74&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;Invoke(MailBoxType)&amp;lt;br&amp;gt;→ MessageDispatcher.Handle()&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1980&quot; y=&quot;980&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;2180&quot; y=&quot;980&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg75&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;HandleAsync()&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;2180&quot; y=&quot;1030&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;2380&quot; y=&quot;1030&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg76&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=middle;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;align=left;&quot; value=&quot;Run(entity, request, response)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;Array as=&quot;points&quot;&gt;&#10;              &lt;mxPoint x=&quot;2450&quot; y=&quot;1070&quot; /&gt;&#10;              &lt;mxPoint x=&quot;2450&quot; y=&quot;1110&quot; /&gt;&#10;            &lt;/Array&gt;&#10;            &lt;mxPoint x=&quot;2380&quot; y=&quot;1070&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;2380&quot; y=&quot;1110&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg77&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;ProcessInnerSender.Reply(fromAddr, response)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;2380&quot; y=&quot;1170&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1770&quot; y=&quot;1170&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg78&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;SendInner&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1770&quot; y=&quot;1220&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1555&quot; y=&quot;1220&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg79&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;取出响应消息&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1555&quot; y=&quot;1270&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;1230&quot; y=&quot;1270&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg80&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=open;endFill=0;dashed=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;HandleIActorResponse&amp;lt;br&amp;gt;设置RpcInfo完成, await返回IResponse&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;1230&quot; y=&quot;1320&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;1320&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg81&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;恢复客户端RpcId, session.Send(iResponse)&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;1380&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;1380&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg82&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=block;endFill=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;序列化, AService.Send()&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;420&quot; y=&quot;1430&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;1430&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;msg83&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;html=1;verticalAlign=bottom;endArrow=open;endFill=0;dashed=1;curved=0;rounded=0;fontSize=10;&quot; value=&quot;TCP/KCP 返回响应&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;240&quot; y=&quot;1480&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;80&quot; y=&quot;1480&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;note_session&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=12;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;align=left;spacingLeft=5;rounded=0;&quot; value=&quot;Gate 直接处理的请求（如 C2G_LoginGate）。&amp;lt;br&amp;gt;Handler 内部直接调用 session.Send(response) 回复客户端。&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;340&quot; x=&quot;560&quot; y=&quot;385&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;note_location&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=12;fontSize=10;fillColor=#fff2cc;strokeColor=#d6b656;align=left;spacingLeft=5;rounded=0;&quot; value=&quot;转发到 Map 的请求（如客户端发给 Map 上 Unit 的消息）。&amp;lt;br&amp;gt;Gate 保存客户端 RpcId → 转发至 Map → Map 处理返回 → Gate 恢复 RpcId 后回复客户端。&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;290&quot; x=&quot;510&quot; y=&quot;740&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;note_cross&quot; parent=&quot;1&quot; style=&quot;shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;size=12;fontSize=10;fillColor=#f8cecc;strokeColor=#b85450;align=left;spacingLeft=5;rounded=0;&quot; value=&quot;注: 跨进程通信时，MessageSender 会将消息封装为 A2NetInner_Request，&amp;lt;br&amp;gt;通过 NetInner Fiber 的 ProcessOuterSender 经 TCP 发送到目标进程。&amp;lt;br&amp;gt;本图仅展示同进程内 Fiber 间通信（经 MessageQueue）。&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;55&quot; width=&quot;430&quot; x=&quot;10&quot; y=&quot;1600&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;note_mq&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=center;verticalAlign=top;fontSize=9;fontStyle=2;fontColor=#6c8ebf;rounded=0;&quot; value=&quot;跨Fiber共享&amp;lt;br&amp;gt;(ConcurrentQueue)&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;150&quot; x=&quot;1480&quot; y=&quot;145&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;legend_title&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=left;fontSize=14;fontStyle=1;rounded=0;&quot; value=&quot;图例说明&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;30&quot; width=&quot;100&quot; x=&quot;500&quot; y=&quot;1600&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;leg_sync&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=block;endFill=1;html=1;fontSize=10;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;510&quot; y=&quot;1645&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;1645&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;leg_sync_lbl&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=left;fontSize=10;rounded=0;&quot; value=&quot;同步方法调用&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;100&quot; x=&quot;620&quot; y=&quot;1633&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;leg_ret&quot; edge=&quot;1&quot; parent=&quot;1&quot; style=&quot;endArrow=open;endFill=0;dashed=1;html=1;fontSize=10;rounded=0;&quot; value=&quot;&quot;&gt;&#10;          &lt;mxGeometry relative=&quot;1&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxPoint x=&quot;510&quot; y=&quot;1675&quot; as=&quot;sourcePoint&quot; /&gt;&#10;            &lt;mxPoint x=&quot;610&quot; y=&quot;1675&quot; as=&quot;targetPoint&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;leg_ret_lbl&quot; parent=&quot;1&quot; style=&quot;text;html=1;align=left;fontSize=10;rounded=0;&quot; value=&quot;返回 / 网络响应 / 异步回调&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;200&quot; x=&quot;620&quot; y=&quot;1663&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_1&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;210&quot; y=&quot;170&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_2&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;2&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;390&quot; y=&quot;220&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_3&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;3&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;560&quot; y=&quot;270&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_4&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;4&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;660&quot; y=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_5&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;5&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;1130&quot; y=&quot;490&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_6&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;6&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;770&quot; y=&quot;560&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_7&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;7&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;610&quot; y=&quot;718&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_8&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;8&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;1000&quot; y=&quot;770&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_9&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;9&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;1420&quot; y=&quot;805&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_10&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;10&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;1690&quot; y=&quot;850&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_11&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;11&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;1920&quot; y=&quot;900&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_12&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;12&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;2130&quot; y=&quot;940&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_13&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;13&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;2415&quot; y=&quot;1048&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_14&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;14&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;2140&quot; y=&quot;1140&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_15&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;15&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;970&quot; y=&quot;1270&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_16&quot; parent=&quot;1&quot; style=&quot;ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;rounded=0;&quot; value=&quot;16&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;20&quot; width=&quot;20&quot; x=&quot;550&quot; y=&quot;1340&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_table&quot; parent=&quot;1&quot; style=&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;640&quot; width=&quot;1270&quot; x=&quot;10&quot; y=&quot;1840&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r1&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r1_n&quot; parent=&quot;sn_r1&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r1_d&quot; parent=&quot;sn_r1&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;客户端通过KCP协议发送请求到Gate的NetComponent。AService（KService）接收原始字节流&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r2&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r2_n&quot; parent=&quot;sn_r2&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;2&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r2_d&quot; parent=&quot;sn_r2&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;NetComponent.OnRead()触发ReadCallback，解析Opcode，通过MemoryPack反序列化为消息对象&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r3&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r3_n&quot; parent=&quot;sn_r3&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;3&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r3_d&quot; parent=&quot;sn_r3&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;EventSystem.Invoke按当前Scene的SceneType（Gate）分发，调用NetComponentOnReadInvoker_Gate&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r4&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r4_n&quot; parent=&quot;sn_r4&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;4&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r4_d&quot; parent=&quot;sn_r4&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;Invoker根据消息接口类型分支：ISessionMessage由Gate直接处理，不跨Fiber转发（如C2G_LoginGate）&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r5&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r5_n&quot; parent=&quot;sn_r5&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;5&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r5_d&quot; parent=&quot;sn_r5&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;MessageSessionDispatcher分发到具体的MessageSessionHandler派生类（如C2G_LoginGateHandler），执行Run()处理请求&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r6&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r6_n&quot; parent=&quot;sn_r6&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;6&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r6_d&quot; parent=&quot;sn_r6&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;Handler直接调用session.Send(response)回复客户端，Session序列化后由AService发送到网络&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r7&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;240&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r7_n&quot; parent=&quot;sn_r7&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;7&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r7_d&quot; parent=&quot;sn_r7&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;ILocationRequest类型需转发到目标Fiber。&amp;lt;font color=&amp;quot;#CC0000&amp;quot;&amp;gt;Gate先保存客户端RpcId，替换为内部RpcId后转发&amp;lt;/font&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r8&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;280&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r8_n&quot; parent=&quot;sn_r8&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;8&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r8_d&quot; parent=&quot;sn_r8&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;消息路由链：MessageLocationSenderOneType → Location解析ActorId → MessageSender → ProcessInnerSender&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r9&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;320&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r9_n&quot; parent=&quot;sn_r9&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;9&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r9_d&quot; parent=&quot;sn_r9&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;Gate的ProcessInnerSender.SendInner()按目标Fiber分组，放入&amp;lt;span style=&amp;quot;background-color: rgb(51, 153, 255);&amp;quot;&amp;gt;MessageQueue&amp;lt;/span&amp;gt;（线程安全ConcurrentQueue，跨Fiber共享）&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r10&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;360&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r10_n&quot; parent=&quot;sn_r10&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;10&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r10_d&quot; parent=&quot;sn_r10&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;&amp;lt;span style=&amp;quot;background-color: rgb(0, 204, 0);&amp;quot;&amp;gt;Map Fiber&amp;lt;/span&amp;gt;的ProcessInnerSender在HandleMessage()中从MessageQueue取出属于自己Fiber的消息列表&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r11&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;400&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r11_n&quot; parent=&quot;sn_r11&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;11&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r11_d&quot; parent=&quot;sn_r11&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;消息投递到目标Entity的MailBoxComponent信箱，Add()方法将消息入队等待处理&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r12&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;440&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r12_n&quot; parent=&quot;sn_r12&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;12&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r12_d&quot; parent=&quot;sn_r12&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;MailBoxComponent按MailBoxType通过Invoke分发：OrderedMessage保序处理 / GateSession转发等，调用MessageDispatcher.Handle()&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r13&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;480&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r13_n&quot; parent=&quot;sn_r13&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;13&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r13_d&quot; parent=&quot;sn_r13&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;MessageDispatcher → MessageHandler.Run()在&amp;lt;span style=&amp;quot;background-color: rgb(0, 204, 0);&amp;quot;&amp;gt;Map Fiber&amp;lt;/span&amp;gt;上执行业务逻辑（如移动、战斗等游戏逻辑）&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r14&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;520&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r14_n&quot; parent=&quot;sn_r14&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;14&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r14_d&quot; parent=&quot;sn_r14&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;处理完毕，Reply()将Response经Map的ProcessInnerSender → MessageQueue → Gate的ProcessInnerSender原路返回&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r15&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;560&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r15_n&quot; parent=&quot;sn_r15&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;15&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r15_d&quot; parent=&quot;sn_r15&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;Gate收到Response后，HandleIActorResponse匹配内部RpcId，设置ETTask完成，await返回IResponse&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r16&quot; parent=&quot;sn_table&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;rounded=0;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1270&quot; y=&quot;600&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r16_n&quot; parent=&quot;sn_r16&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;rounded=0;&quot; value=&quot;16&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;sn_r16_d&quot; parent=&quot;sn_r16&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;rounded=0;&quot; value=&quot;&amp;lt;font color=&amp;quot;#CC0000&amp;quot;&amp;gt;Gate恢复客户端原始RpcId写入Response&amp;lt;/font&amp;gt;，调用session.Send(iResponse)经KCP回复客户端&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1210&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;1210&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; parent=&quot;1&quot; style=&quot;shape=table;startSize=0;container=1;collapsible=0;childLayout=tableLayout;fontSize=16;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;240&quot; width=&quot;1020&quot; x=&quot;10&quot; y=&quot;2560&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-4&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1020&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-5&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-4&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;&quot; value=&quot;1&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-6&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-4&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;ISessionMessage&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;: Gate 直接处理并回复的请求（不经过其他 Fiber），如 C2G_LoginGate&amp;lt;/span&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;960&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;960&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-8&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1020&quot; y=&quot;40&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-9&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-8&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;&quot; value=&quot;2&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-10&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-8&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;ILocationRequest&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;: 需转发到目标 Fiber（如 Map）处理的请求，通过 Location 系统路由&amp;lt;/span&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;960&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;960&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-12&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;&quot; value=&quot;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1020&quot; y=&quot;80&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-13&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-12&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;&quot; value=&quot;3&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-14&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-12&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;MessageQueue&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;: 线程安全的 ConcurrentQueue，同进程跨 Fiber 消息传递&amp;lt;/span&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;960&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;960&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-16&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1020&quot; y=&quot;120&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-17&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-16&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;&quot; value=&quot;4&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-18&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-16&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;ProcessInnerSender&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;: 每个 Fiber 都有，负责同进程 Fiber 间消息投递（SendInner）和接收（HandleMessage）&amp;lt;/span&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;960&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;960&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-24&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1020&quot; y=&quot;160&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-25&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-24&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;&quot; value=&quot;5&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-26&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-24&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;MailBoxComponent&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;: Actor 信箱，收到消息后按 MailBoxType 分发（OrderedMessage / GateSession 等）&amp;lt;/span&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;960&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;960&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-20&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-3&quot; style=&quot;shape=tableRow;horizontal=0;startSize=0;swimlaneHead=0;swimlaneBody=0;strokeColor=inherit;top=0;left=0;bottom=0;right=0;collapsible=0;dropTarget=0;fillColor=none;points=[[0,0.5],[1,0.5]];portConstraint=eastwest;fontSize=16;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;1020&quot; y=&quot;200&quot; as=&quot;geometry&quot; /&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-21&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-20&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;&quot; value=&quot;6&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;60&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;        &lt;mxCell id=&quot;LnJcN-0OFBurzp4TWZd0-22&quot; parent=&quot;LnJcN-0OFBurzp4TWZd0-20&quot; style=&quot;shape=partialRectangle;html=1;whiteSpace=wrap;connectable=0;strokeColor=inherit;overflow=hidden;fillColor=none;top=0;left=0;bottom=0;right=0;pointerEvents=1;fontSize=16;align=left;&quot; value=&quot;&amp;lt;b style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;RpcId 流转&amp;lt;/b&amp;gt;&amp;lt;span style=&amp;quot;text-wrap-mode: nowrap;&amp;quot;&amp;gt;: Gate 保存客户端 rpcId → 转发时使用内部 rpcId → Map 返回时带内部 rpcId → Gate 恢复客户端 rpcId&amp;lt;/span&amp;gt;&quot; vertex=&quot;1&quot;&gt;&#10;          &lt;mxGeometry height=&quot;40&quot; width=&quot;960&quot; x=&quot;60&quot; as=&quot;geometry&quot;&gt;&#10;            &lt;mxRectangle height=&quot;40&quot; width=&quot;960&quot; as=&quot;alternateBounds&quot; /&gt;&#10;          &lt;/mxGeometry&gt;&#10;        &lt;/mxCell&gt;&#10;      &lt;/root&gt;&#10;    &lt;/mxGraphModel&gt;&#10;  &lt;/diagram&gt;&#10;&lt;/mxfile&gt;&#10;"><defs/><g><g data-cell-id="0"><g data-cell-id="1"><g data-cell-id="bg_gate"><g transform="translate(0.5,0.5)"><rect x="0" y="0" width="1450" height="1570" fill-opacity="0.3" fill="#ffe6cc" stroke="#d79b00" stroke-opacity="0.3" pointer-events="all" style="fill: light-dark(rgb(255, 230, 204), rgb(54, 33, 10)); stroke: light-dark(rgb(215, 155, 0), rgb(153, 101, 0));"/></g></g><g data-cell-id="lbl_gate"><g transform="translate(0.5,0.5)"><rect x="620" y="10" width="170" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 30px; margin-left: 705px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 24px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: nowrap; ">Gate Fiber</div></div></div></foreignObject><text x="705" y="37" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="24px" text-anchor="middle" font-weight="bold">Gate Fiber</text></switch></g></g></g><g data-cell-id="bg_map"><g transform="translate(0.5,0.5)"><rect x="1650" y="0" width="870" height="1570" fill-opacity="0.3" fill="#d5e8d4" stroke="#82b366" stroke-opacity="0.3" pointer-events="all" style="fill: light-dark(rgb(213, 232, 212), rgb(31, 47, 30)); stroke: light-dark(rgb(130, 179, 102), rgb(68, 110, 44));"/></g></g><g data-cell-id="lbl_map"><g transform="translate(0.5,0.5)"><rect x="2010" y="10" width="140" height="40" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 30px; margin-left: 2080px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 24px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: nowrap; ">Map Fiber</div></div></div></foreignObject><text x="2080" y="37" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="24px" text-anchor="middle" font-weight="bold">Map Fiber</text></switch></g></g></g><g data-cell-id="bg_mq"><g transform="translate(0.5,0.5)"><rect x="1460" y="0" width="180" height="1570" fill-opacity="0.2" fill="#dae8fc" stroke="#6c8ebf" stroke-opacity="0.2" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g></g><g data-cell-id="p1_head"><g transform="translate(0.5,0.5)"><ellipse cx="70" cy="61.25" rx="7.5" ry="6.25" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 70 67.5 L 70 88.33 M 70 71.67 L 55 71.67 M 70 71.67 L 85 71.67 M 70 88.33 L 55 105 M 70 88.33 L 85 105" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="p2"><g transform="translate(0.5,0.5)"><rect x="150" y="70" width="160" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 90px; margin-left: 151px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:NetComponent</div></div></div></foreignObject><text x="230" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">:NetComponent</text></switch></g></g></g><g data-cell-id="p3"><g transform="translate(0.5,0.5)"><rect x="350" y="70" width="120" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 118px; height: 1px; padding-top: 90px; margin-left: 351px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:Session</div></div></div></foreignObject><text x="410" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">:Session</text></switch></g></g></g><g data-cell-id="p4"><g transform="translate(0.5,0.5)"><rect x="500" y="70" width="200" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 198px; height: 1px; padding-top: 90px; margin-left: 501px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:NetComponentOnRead<br />Invoker_Gate</div></div></div></foreignObject><text x="600" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:NetComponentOnRead...</text></switch></g></g></g><g data-cell-id="p5"><g transform="translate(0.5,0.5)"><rect x="730" y="70" width="170" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 90px; margin-left: 731px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:MessageSession<br />Dispatcher</div></div></div></foreignObject><text x="815" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:MessageSession...</text></switch></g></g></g><g data-cell-id="p6"><g transform="translate(0.5,0.5)"><rect x="930" y="70" width="170" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 168px; height: 1px; padding-top: 90px; margin-left: 931px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:MessageSession<br />Handler</div></div></div></foreignObject><text x="1015" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:MessageSession...</text></switch></g></g></g><g data-cell-id="p7"><g transform="translate(0.5,0.5)"><rect x="1130" y="70" width="180" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 90px; margin-left: 1131px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:ProcessInnerSender<br />(Gate Fiber)</div></div></div></foreignObject><text x="1220" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:ProcessInnerSender...</text></switch></g></g></g><g data-cell-id="p8"><g transform="translate(0.5,0.5)"><rect x="1470" y="70" width="150" height="40" fill="#dae8fc" stroke="#6c8ebf" pointer-events="all" style="fill: light-dark(rgb(218, 232, 252), rgb(29, 41, 59)); stroke: light-dark(rgb(108, 142, 191), rgb(92, 121, 163));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 148px; height: 1px; padding-top: 90px; margin-left: 1471px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:MessageQueue</div></div></div></foreignObject><text x="1545" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" text-anchor="middle">:MessageQueue</text></switch></g></g></g><g data-cell-id="p9"><g transform="translate(0.5,0.5)"><rect x="1670" y="70" width="180" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 178px; height: 1px; padding-top: 90px; margin-left: 1671px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:ProcessInnerSender<br />(Map Fiber)</div></div></div></foreignObject><text x="1760" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:ProcessInnerSender...</text></switch></g></g></g><g data-cell-id="p10"><g transform="translate(0.5,0.5)"><rect x="1890" y="70" width="160" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 90px; margin-left: 1891px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:MailBoxComponent</div></div></div></foreignObject><text x="1970" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:MailBoxComponent</text></switch></g></g></g><g data-cell-id="p11"><g transform="translate(0.5,0.5)"><rect x="2090" y="70" width="160" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 90px; margin-left: 2091px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:MessageDispatcher</div></div></div></foreignObject><text x="2170" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:MessageDispatcher</text></switch></g></g></g><g data-cell-id="p12"><g transform="translate(0.5,0.5)"><rect x="2290" y="70" width="160" height="40" fill="#ffffff" stroke="#000000" pointer-events="all" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 158px; height: 1px; padding-top: 90px; margin-left: 2291px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">:MessageHandler</div></div></div></foreignObject><text x="2370" y="93" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">:MessageHandler</text></switch></g></g></g><g data-cell-id="ll1"><g transform="translate(0.5,0.5)"><path d="M 70 110 L 70 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll2"><g transform="translate(0.5,0.5)"><path d="M 230 110 L 230 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll3"><g transform="translate(0.5,0.5)"><path d="M 410 110 L 410 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll4"><g transform="translate(0.5,0.5)"><path d="M 600 110 L 600 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll5"><g transform="translate(0.5,0.5)"><path d="M 815 110 L 815 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll6"><g transform="translate(0.5,0.5)"><path d="M 1015 110 L 1015 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll7"><g transform="translate(0.5,0.5)"><path d="M 1220 110 L 1220 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll8"><g transform="translate(0.5,0.5)"><path d="M 1545 110 L 1545 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll9"><g transform="translate(0.5,0.5)"><path d="M 1760 110 L 1760 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll10"><g transform="translate(0.5,0.5)"><path d="M 1970 110 L 1970 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll11"><g transform="translate(0.5,0.5)"><path d="M 2170 110 L 2170 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="ll12"><g transform="translate(0.5,0.5)"><path d="M 2370 110 L 2370 1530" fill="none" stroke="#999999" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(153, 153, 153), rgb(106, 106, 106));"/></g></g><g data-cell-id="msg60"><g transform="translate(0.5,0.5)"><path d="M 70 170 L 221.88 170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 228.88 170 L 221.88 173.5 L 221.88 166.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 167px; margin-left: 150px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">TCP/KCP 发送请求消息</div></div></div></foreignObject><text x="150" y="167" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">TCP/KCP 发送请求消息</text></switch></g></g></g><g data-cell-id="msg61"><g transform="translate(0.5,0.5)"><path d="M 230 220 L 401.88 220" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 408.88 220 L 401.88 223.5 L 401.88 216.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 217px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">ReadCallback 反序列化消息</div></div></div></foreignObject><text x="320" y="217" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">ReadCallback 反序列化消息</text></switch></g></g></g><g data-cell-id="msg62"><g transform="translate(0.5,0.5)"><path d="M 410 270 L 591.88 270" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 598.88 270 L 591.88 273.5 L 591.88 266.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 267px; margin-left: 505px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Invoke(SceneType.Gate, NetComponentOnRead)</div></div></div></foreignObject><text x="505" y="267" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">Invoke(SceneType.Gate, NetComponentOnRead)</text></switch></g></g></g><g data-cell-id="alt_frame"><g transform="translate(0.5,0.5)"><path d="M 490 310 L 540 310 L 540 320 L 530 335 L 490 335 Z" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 540 310 L 2480 310 L 2480 1490 L 490 1490 L 490 335" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 48px; height: 1px; padding-top: 323px; margin-left: 491px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; word-wrap: normal; ">Alt</div></div></div></foreignObject><text x="515" y="326" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle" font-weight="bold">Alt</text></switch></g></g></g><g data-cell-id="guard1"><g transform="translate(0.5,0.5)"><rect x="550" y="335" width="160" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 342px; margin-left: 552px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: nowrap; ">[ISessionMessage]</div></div></div></foreignObject><text x="552" y="353" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" font-style="italic">[ISessionMessage]</text></switch></g></g></g><g data-cell-id="alt_sep"><g transform="translate(0.5,0.5)"><path d="M 490 680 L 2480 680" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="8 4" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="guard2"><g transform="translate(0.5,0.5)"><rect x="500" y="688" width="170" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 695px; margin-left: 502px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 11px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-style: italic; white-space: nowrap; ">[ILocationRequest]</div></div></div></foreignObject><text x="502" y="706" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="11px" font-style="italic">[ILocationRequest]</text></switch></g></g></g><g data-cell-id="msg63"><g transform="translate(0.5,0.5)"><path d="M 600 380 L 806.88 380" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 813.88 380 L 806.88 383.5 L 806.88 376.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 377px; margin-left: 708px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Handle(session, message)</div></div></div></foreignObject><text x="708" y="377" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">Handle(session, message)</text></switch></g></g></g><g data-cell-id="msg64"><g transform="translate(0.5,0.5)"><path d="M 815 430 L 1006.88 430" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1013.88 430 L 1006.88 433.5 L 1006.88 426.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 427px; margin-left: 915px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">HandleAsync()</div></div></div></foreignObject><text x="915" y="427" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">HandleAsync()</text></switch></g></g></g><g data-cell-id="msg65"><g transform="translate(0.5,0.5)"><path d="M 1015 470 L 1110 470 L 1110 510 L 1023.12 510" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1016.12 510 L 1023.12 506.5 L 1023.12 513.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 490px; margin-left: 1112px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Run(session, request, response)</div></div></div></foreignObject><text x="1112" y="493" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">Run(session, request, response)</text></switch></g></g></g><g data-cell-id="msg66"><g transform="translate(0.5,0.5)"><path d="M 1015 560 L 418.12 560" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 411.12 560 L 418.12 556.5 L 418.12 563.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 557px; margin-left: 713px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">session.Send(response)</div></div></div></foreignObject><text x="713" y="557" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">session.Send(response)</text></switch></g></g></g><g data-cell-id="msg67"><g transform="translate(0.5,0.5)"><path d="M 410 610 L 238.12 610" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 231.12 610 L 238.12 606.5 L 238.12 613.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 607px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">序列化, AService.Send()</div></div></div></foreignObject><text x="320" y="607" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">序列化, AService.Send()</text></switch></g></g></g><g data-cell-id="msg68"><g transform="translate(0.5,0.5)"><path d="M 230 650 L 72.24 650" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 78.12 646.5 L 71.12 650 L 78.12 653.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 647px; margin-left: 150px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">TCP/KCP 返回响应</div></div></div></foreignObject><text x="150" y="647" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">TCP/KCP 返回响应</text></switch></g></g></g><g data-cell-id="msg70"><g transform="translate(0.5,0.5)"><path d="M 600 774.17 L 1211.88 774.17" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1218.88 774.17 L 1211.88 777.67 L 1211.88 770.67 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 771px; margin-left: 910px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">MessageLocationSender.Call()<br />→ MessageSender.Call()</div></div></div></foreignObject><text x="910" y="771" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">MessageLocationSender.Call()...</text></switch></g></g></g><g data-cell-id="note70"><g transform="translate(0.5,0.5)"><rect x="820" y="775" width="300" height="25" fill="none" stroke="none" pointer-events="all"/></g><g><g fill="#888888" font-family="Helvetica" font-style="italic" font-size="9px" style="fill: light-dark(rgb(136, 136, 136), rgb(120, 120, 120));"><text x="822" y="790">实际经过 MessageLocationSenderOneType</text><text x="822" y="801">→ MessageSender → ProcessInnerSender</text></g></g></g><g data-cell-id="msg71"><g transform="translate(0.5,0.5)"><path d="M 1220 800 L 1536.88 800" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1543.88 800 L 1536.88 803.5 L 1536.88 796.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 797px; margin-left: 1383px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">SendInner</div></div></div></foreignObject><text x="1383" y="797" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">SendInner</text></switch></g></g></g><g data-cell-id="msg72"><g transform="translate(0.5,0.5)"><path d="M 1545 850 L 1751.88 850" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1758.88 850 L 1751.88 853.5 L 1751.88 846.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 847px; margin-left: 1653px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">取出消息列表</div></div></div></foreignObject><text x="1653" y="847" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">取出消息列表</text></switch></g></g></g><g data-cell-id="msg73"><g transform="translate(0.5,0.5)"><path d="M 1760 900 L 1961.88 900" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1968.88 900 L 1961.88 903.5 L 1961.88 896.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 897px; margin-left: 1865px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">MailBoxComponent.Add(fromAddr, msg)</div></div></div></foreignObject><text x="1865" y="897" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">MailBoxComponent.Add(fromAddr, msg)</text></switch></g></g></g><g data-cell-id="msg74"><g transform="translate(0.5,0.5)"><path d="M 1970 950 L 2161.88 950" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2168.88 950 L 2161.88 953.5 L 2161.88 946.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 947px; margin-left: 2070px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Invoke(MailBoxType)<br />→ MessageDispatcher.Handle()</div></div></div></foreignObject><text x="2070" y="947" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">Invoke(MailBoxType)...</text></switch></g></g></g><g data-cell-id="msg75"><g transform="translate(0.5,0.5)"><path d="M 2170 1000 L 2361.88 1000" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2368.88 1000 L 2361.88 1003.5 L 2361.88 996.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 997px; margin-left: 2270px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">HandleAsync()</div></div></div></foreignObject><text x="2270" y="997" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">HandleAsync()</text></switch></g></g></g><g data-cell-id="msg76"><g transform="translate(0.5,0.5)"><path d="M 2370 1040 L 2440 1040 L 2440 1080 L 2378.12 1080" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 2371.12 1080 L 2378.12 1076.5 L 2378.12 1083.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1060px; margin-left: 2442px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">Run(entity, request, response)</div></div></div></foreignObject><text x="2442" y="1063" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">Run(entity, request, response)</text></switch></g></g></g><g data-cell-id="msg77"><g transform="translate(0.5,0.5)"><path d="M 2370 1140 L 1768.12 1140" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1761.12 1140 L 1768.12 1136.5 L 1768.12 1143.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1137px; margin-left: 2065px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">ProcessInnerSender.Reply(fromAddr, response)</div></div></div></foreignObject><text x="2065" y="1137" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">ProcessInnerSender.Reply(fromAddr, response)</text></switch></g></g></g><g data-cell-id="msg78"><g transform="translate(0.5,0.5)"><path d="M 1760 1190 L 1553.12 1190" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1546.12 1190 L 1553.12 1186.5 L 1553.12 1193.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1187px; margin-left: 1653px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">SendInner</div></div></div></foreignObject><text x="1653" y="1187" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">SendInner</text></switch></g></g></g><g data-cell-id="msg79"><g transform="translate(0.5,0.5)"><path d="M 1545 1240 L 1228.12 1240" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 1221.12 1240 L 1228.12 1236.5 L 1228.12 1243.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1237px; margin-left: 1383px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">取出响应消息</div></div></div></foreignObject><text x="1383" y="1237" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">取出响应消息</text></switch></g></g></g><g data-cell-id="msg80"><g transform="translate(0.5,0.5)"><path d="M 1220 1290 L 602.24 1290" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 608.12 1286.5 L 601.12 1290 L 608.12 1293.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1287px; margin-left: 910px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">HandleIActorResponse<br />设置RpcInfo完成, await返回IResponse</div></div></div></foreignObject><text x="910" y="1287" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">HandleIActorResponse...</text></switch></g></g></g><g data-cell-id="msg81"><g transform="translate(0.5,0.5)"><path d="M 600 1350 L 418.12 1350" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 411.12 1350 L 418.12 1346.5 L 418.12 1353.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1347px; margin-left: 505px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">恢复客户端RpcId, session.Send(iResponse)</div></div></div></foreignObject><text x="505" y="1347" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">恢复客户端RpcId, session.Send(iResponse)</text></switch></g></g></g><g data-cell-id="msg82"><g transform="translate(0.5,0.5)"><path d="M 410 1400 L 238.12 1400" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 231.12 1400 L 238.12 1396.5 L 238.12 1403.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1397px; margin-left: 320px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">序列化, AService.Send()</div></div></div></foreignObject><text x="320" y="1397" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">序列化, AService.Send()</text></switch></g></g></g><g data-cell-id="msg83"><g transform="translate(0.5,0.5)"><path d="M 230 1450 L 72.24 1450" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 78.12 1446.5 L 71.12 1450 L 78.12 1453.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-end; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 1447px; margin-left: 150px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; background-color: #ffffff; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); white-space: nowrap; ">TCP/KCP 返回响应</div></div></div></foreignObject><text x="150" y="1447" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px" text-anchor="middle">TCP/KCP 返回响应</text></switch></g></g></g><g data-cell-id="note_session"><g transform="translate(0.5,0.5)"><path d="M 550 355 L 878 355 L 890 367 L 890 395 L 550 395 L 550 355 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 878 355 L 878 367 L 890 367" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 333px; height: 1px; padding-top: 375px; margin-left: 557px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Gate 直接处理的请求（如 C2G_LoginGate）。<br />Handler 内部直接调用 session.Send(response) 回复客户端。</div></div></div></foreignObject><text x="557" y="378" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">Gate 直接处理的请求（如 C2G_LoginGate）。...</text></switch></g></g></g><g data-cell-id="note_location"><g transform="translate(0.5,0.5)"><path d="M 500 710 L 778 710 L 790 722 L 790 750 L 500 750 L 500 710 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(255, 242, 204), rgb(40, 29, 0)); stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/><path d="M 778 710 L 778 722 L 790 722" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(214, 182, 86), rgb(109, 81, 0));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 283px; height: 1px; padding-top: 730px; margin-left: 507px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">转发到 Map 的请求（如客户端发给 Map 上 Unit 的消息）。<br />Gate 保存客户端 RpcId → 转发至 Map → Map 处理返回 → Gate 恢复 RpcId 后回复客户端。</div></div></div></foreignObject><text x="507" y="733" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">转发到 Map 的请求（如客户端发给 Map 上 Unit 的消息）。...</text></switch></g></g></g><g data-cell-id="note_cross"><g transform="translate(0.5,0.5)"><path d="M 0 1570 L 418 1570 L 430 1582 L 430 1625 L 0 1625 L 0 1570 Z" fill="#f8cecc" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/><path d="M 418 1570 L 418 1582 L 430 1582" fill="none" stroke="#b85450" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 423px; height: 1px; padding-top: 1598px; margin-left: 7px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">注: 跨进程通信时，MessageSender 会将消息封装为 A2NetInner_Request，<br />通过 NetInner Fiber 的 ProcessOuterSender 经 TCP 发送到目标进程。<br />本图仅展示同进程内 Fiber 间通信（经 MessageQueue）。</div></div></div></foreignObject><text x="7" y="1601" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">注: 跨进程通信时，MessageSender 会将消息封装为 A2NetInner_Request，...</text></switch></g></g></g><g data-cell-id="note_mq"><g transform="translate(0.5,0.5)"><rect x="1470" y="115" width="150" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe center; width: 1px; height: 1px; padding-top: 122px; margin-left: 1545px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #6c8ebf; "><div style="display: inline-block; font-size: 9px; font-family: Helvetica; color: light-dark(#6c8ebf, #5c79a3); line-height: 1.2; pointer-events: all; font-style: italic; white-space: nowrap; ">跨Fiber共享<br />(ConcurrentQueue)</div></div></div></foreignObject><text x="1545" y="131" fill="#6c8ebf" font-family="Helvetica" font-size="9px" text-anchor="middle" font-style="italic">跨Fiber共享...</text></switch></g></g></g><g data-cell-id="legend_title"><g transform="translate(0.5,0.5)"><rect x="490" y="1570" width="100" height="30" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1577px; margin-left: 492px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: nowrap; ">图例说明</div></div></div></foreignObject><text x="492" y="1591" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="14px" font-weight="bold">图例说明</text></switch></g></g></g><g data-cell-id="leg_sync"><g transform="translate(0.5,0.5)"><path d="M 500 1615 L 591.88 1615" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 598.88 1615 L 591.88 1618.5 L 591.88 1611.5 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="fill: light-dark(rgb(0, 0, 0), rgb(255, 255, 255)); stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="leg_sync_lbl"><g transform="translate(0.5,0.5)"><rect x="610" y="1603" width="100" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1610px; margin-left: 612px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; ">同步方法调用</div></div></div></foreignObject><text x="612" y="1620" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">同步方法调用</text></switch></g></g></g><g data-cell-id="leg_ret"><g transform="translate(0.5,0.5)"><path d="M 500 1645 L 597.76 1645" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="stroke" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 591.88 1648.5 L 598.88 1645 L 591.88 1641.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g></g><g data-cell-id="leg_ret_lbl"><g transform="translate(0.5,0.5)"><rect x="610" y="1633" width="200" height="20" fill="none" stroke="none" pointer-events="all"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1640px; margin-left: 612px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; color: #000000; "><div style="display: inline-block; font-size: 10px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: nowrap; ">返回 / 网络响应 / 异步回调</div></div></div></foreignObject><text x="612" y="1650" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="10px">返回 / 网络响应 / 异步回调</text></switch></g></g></g><g data-cell-id="sn_1"><g transform="translate(0.5,0.5)"><ellipse cx="210" cy="150" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 150px; margin-left: 201px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1</div></div></div></foreignObject><text x="210" y="154" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">1</text></switch></g></g></g><g data-cell-id="sn_2"><g transform="translate(0.5,0.5)"><ellipse cx="390" cy="200" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 200px; margin-left: 381px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">2</div></div></div></foreignObject><text x="390" y="204" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">2</text></switch></g></g></g><g data-cell-id="sn_3"><g transform="translate(0.5,0.5)"><ellipse cx="560" cy="250" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 250px; margin-left: 551px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">3</div></div></div></foreignObject><text x="560" y="254" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">3</text></switch></g></g></g><g data-cell-id="sn_4"><g transform="translate(0.5,0.5)"><ellipse cx="660" cy="340" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 340px; margin-left: 651px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">4</div></div></div></foreignObject><text x="660" y="344" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">4</text></switch></g></g></g><g data-cell-id="sn_5"><g transform="translate(0.5,0.5)"><ellipse cx="1130" cy="470" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 470px; margin-left: 1121px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">5</div></div></div></foreignObject><text x="1130" y="474" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">5</text></switch></g></g></g><g data-cell-id="sn_6"><g transform="translate(0.5,0.5)"><ellipse cx="770" cy="540" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 540px; margin-left: 761px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">6</div></div></div></foreignObject><text x="770" y="544" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">6</text></switch></g></g></g><g data-cell-id="sn_7"><g transform="translate(0.5,0.5)"><ellipse cx="610" cy="698" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 698px; margin-left: 601px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">7</div></div></div></foreignObject><text x="610" y="702" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">7</text></switch></g></g></g><g data-cell-id="sn_8"><g transform="translate(0.5,0.5)"><ellipse cx="1000" cy="750" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 750px; margin-left: 991px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">8</div></div></div></foreignObject><text x="1000" y="754" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">8</text></switch></g></g></g><g data-cell-id="sn_9"><g transform="translate(0.5,0.5)"><ellipse cx="1420" cy="785" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 785px; margin-left: 1411px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">9</div></div></div></foreignObject><text x="1420" y="789" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">9</text></switch></g></g></g><g data-cell-id="sn_10"><g transform="translate(0.5,0.5)"><ellipse cx="1690" cy="830" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 830px; margin-left: 1681px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">10</div></div></div></foreignObject><text x="1690" y="834" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">10</text></switch></g></g></g><g data-cell-id="sn_11"><g transform="translate(0.5,0.5)"><ellipse cx="1920" cy="880" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 880px; margin-left: 1911px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">11</div></div></div></foreignObject><text x="1920" y="884" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">11</text></switch></g></g></g><g data-cell-id="sn_12"><g transform="translate(0.5,0.5)"><ellipse cx="2130" cy="920" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 920px; margin-left: 2121px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">12</div></div></div></foreignObject><text x="2130" y="924" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">12</text></switch></g></g></g><g data-cell-id="sn_13"><g transform="translate(0.5,0.5)"><ellipse cx="2415" cy="1028" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 1028px; margin-left: 2406px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">13</div></div></div></foreignObject><text x="2415" y="1032" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">13</text></switch></g></g></g><g data-cell-id="sn_14"><g transform="translate(0.5,0.5)"><ellipse cx="2140" cy="1120" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 1120px; margin-left: 2131px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">14</div></div></div></foreignObject><text x="2140" y="1124" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">14</text></switch></g></g></g><g data-cell-id="sn_15"><g transform="translate(0.5,0.5)"><ellipse cx="970" cy="1250" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 1250px; margin-left: 961px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">15</div></div></div></foreignObject><text x="970" y="1254" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">15</text></switch></g></g></g><g data-cell-id="sn_16"><g transform="translate(0.5,0.5)"><ellipse cx="550" cy="1320" rx="10" ry="10" fill="#f8cecc" stroke="#b85450" pointer-events="all" style="fill: light-dark(rgb(248, 206, 204), rgb(81, 45, 43)); stroke: light-dark(rgb(184, 84, 80), rgb(215, 129, 126));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 18px; height: 1px; padding-top: 1320px; margin-left: 541px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; color: #000000; "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">16</div></div></div></foreignObject><text x="550" y="1324" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="12px" text-anchor="middle">16</text></switch></g></g></g><g data-cell-id="sn_table"><g transform="translate(0.5,0.5)"><rect x="0" y="1810" width="1270" height="640" fill="#ffffff" stroke="none" pointer-events="none" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212));"/><path d="M 0 1810 L 1270 1810 L 1270 2450 L 0 2450 L 0 1810" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1850 L 60 1850 L 1270 1850" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1890 L 60 1890 L 1270 1890" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1930 L 60 1930 L 1270 1930" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 1970 L 60 1970 L 1270 1970" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2010 L 60 2010 L 1270 2010" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2050 L 60 2050 L 1270 2050" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2090 L 60 2090 L 1270 2090" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2130 L 60 2130 L 1270 2130" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2170 L 60 2170 L 1270 2170" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2210 L 60 2210 L 1270 2210" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2250 L 60 2250 L 1270 2250" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2290 L 60 2290 L 1270 2290" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2330 L 60 2330 L 1270 2330" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2370 L 60 2370 L 1270 2370" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2410 L 60 2410 L 1270 2410" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 60 1810 L 60 1850 L 60 1890 L 60 1930 L 60 1970 L 60 2010 L 60 2050 L 60 2090 L 60 2130 L 60 2170 L 60 2210 L 60 2250 L 60 2290 L 60 2330 L 60 2370 L 60 2410 L 60 2450" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="sn_r1"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r1_n"><g transform="translate(0.5,0.5)"><rect x="0" y="1810" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 1810 M 60 1810 M 60 1850 M 0 1850" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 1830px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1</div></div></div></foreignObject><text x="30" y="1835" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">1</text></switch></g></g></g><g data-cell-id="sn_r1_d"><g transform="translate(0.5,0.5)"><rect x="60" y="1810" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 1810 M 1270 1810 M 1270 1850 M 60 1850" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 1830px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">客户端通过KCP协议发送请求到Gate的NetComponent。AService（KService）接收原始字节流</div></div></div></foreignObject><text x="62" y="1835" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">客户端通过KCP协议发送请求到Gate的NetComponent。AService（KService）接收原始字节流</text></switch></g></g></g></g><g data-cell-id="sn_r2"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r2_n"><g transform="translate(0.5,0.5)"><rect x="0" y="1850" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 1850 M 60 1850 M 60 1890 M 0 1890" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 1870px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">2</div></div></div></foreignObject><text x="30" y="1875" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">2</text></switch></g></g></g><g data-cell-id="sn_r2_d"><g transform="translate(0.5,0.5)"><rect x="60" y="1850" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 1850 M 1270 1850 M 1270 1890 M 60 1890" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 1870px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">NetComponent.OnRead()触发ReadCallback，解析Opcode，通过MemoryPack反序列化为消息对象</div></div></div></foreignObject><text x="62" y="1875" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">NetComponent.OnRead()触发ReadCallback，解析Opcode，通过MemoryPack反序列化为消息对象</text></switch></g></g></g></g><g data-cell-id="sn_r3"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r3_n"><g transform="translate(0.5,0.5)"><rect x="0" y="1890" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 1890 M 60 1890 M 60 1930 M 0 1930" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 1910px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">3</div></div></div></foreignObject><text x="30" y="1915" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">3</text></switch></g></g></g><g data-cell-id="sn_r3_d"><g transform="translate(0.5,0.5)"><rect x="60" y="1890" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 1890 M 1270 1890 M 1270 1930 M 60 1930" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 1910px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">EventSystem.Invoke按当前Scene的SceneType（Gate）分发，调用NetComponentOnReadInvoker_Gate</div></div></div></foreignObject><text x="62" y="1915" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">EventSystem.Invoke按当前Scene的SceneType（Gate）分发，调用NetComponentOnReadInvoker_Gate</text></switch></g></g></g></g><g data-cell-id="sn_r4"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r4_n"><g transform="translate(0.5,0.5)"><rect x="0" y="1930" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 1930 M 60 1930 M 60 1970 M 0 1970" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 1950px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">4</div></div></div></foreignObject><text x="30" y="1955" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">4</text></switch></g></g></g><g data-cell-id="sn_r4_d"><g transform="translate(0.5,0.5)"><rect x="60" y="1930" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 1930 M 1270 1930 M 1270 1970 M 60 1970" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 1950px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Invoker根据消息接口类型分支：ISessionMessage由Gate直接处理，不跨Fiber转发（如C2G_LoginGate）</div></div></div></foreignObject><text x="62" y="1955" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">Invoker根据消息接口类型分支：ISessionMessage由Gate直接处理，不跨Fiber转发（如C2G_LoginGate）</text></switch></g></g></g></g><g data-cell-id="sn_r5"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r5_n"><g transform="translate(0.5,0.5)"><rect x="0" y="1970" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 1970 M 60 1970 M 60 2010 M 0 2010" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 1990px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">5</div></div></div></foreignObject><text x="30" y="1995" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">5</text></switch></g></g></g><g data-cell-id="sn_r5_d"><g transform="translate(0.5,0.5)"><rect x="60" y="1970" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 1970 M 1270 1970 M 1270 2010 M 60 2010" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 1990px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MessageSessionDispatcher分发到具体的MessageSessionHandler派生类（如C2G_LoginGateHandler），执行Run()处理请求</div></div></div></foreignObject><text x="62" y="1995" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">MessageSessionDispatcher分发到具体的MessageSessionHandler派生类（如C2G_LoginGateHandler），执行Run()处理请求</text></switch></g></g></g></g><g data-cell-id="sn_r6"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r6_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2010" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2010 M 60 2010 M 60 2050 M 0 2050" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2030px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">6</div></div></div></foreignObject><text x="30" y="2035" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">6</text></switch></g></g></g><g data-cell-id="sn_r6_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2010" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2010 M 1270 2010 M 1270 2050 M 60 2050" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2030px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Handler直接调用session.Send(response)回复客户端，Session序列化后由AService发送到网络</div></div></div></foreignObject><text x="62" y="2035" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">Handler直接调用session.Send(response)回复客户端，Session序列化后由AService发送到网络</text></switch></g></g></g></g><g data-cell-id="sn_r7"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r7_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2050" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2050 M 60 2050 M 60 2090 M 0 2090" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2070px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">7</div></div></div></foreignObject><text x="30" y="2075" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">7</text></switch></g></g></g><g data-cell-id="sn_r7_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2050" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2050 M 1270 2050 M 1270 2090 M 60 2090" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2070px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">ILocationRequest类型需转发到目标Fiber。<font color="#CC0000" style="color: light-dark(rgb(204, 0, 0), rgb(255, 163, 163));">Gate先保存客户端RpcId，替换为内部RpcId后转发</font></div></div></div></foreignObject><text x="62" y="2075" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">ILocationRequest类型需转发到目标Fiber。Gate先保存客户端RpcId，替换为内部RpcId后转发</text></switch></g></g></g></g><g data-cell-id="sn_r8"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r8_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2090" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2090 M 60 2090 M 60 2130 M 0 2130" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2110px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">8</div></div></div></foreignObject><text x="30" y="2115" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">8</text></switch></g></g></g><g data-cell-id="sn_r8_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2090" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2090 M 1270 2090 M 1270 2130 M 60 2130" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2110px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">消息路由链：MessageLocationSenderOneType → Location解析ActorId → MessageSender → ProcessInnerSender</div></div></div></foreignObject><text x="62" y="2115" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">消息路由链：MessageLocationSenderOneType → Location解析ActorId → MessageSender → ProcessInnerSender</text></switch></g></g></g></g><g data-cell-id="sn_r9"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r9_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2130" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2130 M 60 2130 M 60 2170 M 0 2170" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2150px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">9</div></div></div></foreignObject><text x="30" y="2155" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">9</text></switch></g></g></g><g data-cell-id="sn_r9_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2130" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2130 M 1270 2130 M 1270 2170 M 60 2170" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2150px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Gate的ProcessInnerSender.SendInner()按目标Fiber分组，放入<span style="background-color: light-dark(rgb(51, 153, 255), rgb(43, 130, 218));">MessageQueue</span>（线程安全ConcurrentQueue，跨Fiber共享）</div></div></div></foreignObject><text x="62" y="2155" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">Gate的ProcessInnerSender.SendInner()按目标Fiber分组，放入MessageQueue（线程安全ConcurrentQueue，跨Fiber共享）</text></switch></g></g></g></g><g data-cell-id="sn_r10"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r10_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2170" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2170 M 60 2170 M 60 2210 M 0 2210" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2190px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">10</div></div></div></foreignObject><text x="30" y="2195" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">10</text></switch></g></g></g><g data-cell-id="sn_r10_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2170" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2170 M 1270 2170 M 1270 2210 M 60 2210" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2190px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><span style="background-color: light-dark(rgb(0, 204, 0), rgb(0, 162, 0));">Map Fiber</span>的ProcessInnerSender在HandleMessage()中从MessageQueue取出属于自己Fiber的消息列表</div></div></div></foreignObject><text x="62" y="2195" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">Map Fiber的ProcessInnerSender在HandleMessage()中从MessageQueue取出属于自己Fiber的消息列表</text></switch></g></g></g></g><g data-cell-id="sn_r11"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r11_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2210" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2210 M 60 2210 M 60 2250 M 0 2250" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2230px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">11</div></div></div></foreignObject><text x="30" y="2235" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">11</text></switch></g></g></g><g data-cell-id="sn_r11_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2210" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2210 M 1270 2210 M 1270 2250 M 60 2250" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2230px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">消息投递到目标Entity的MailBoxComponent信箱，Add()方法将消息入队等待处理</div></div></div></foreignObject><text x="62" y="2235" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">消息投递到目标Entity的MailBoxComponent信箱，Add()方法将消息入队等待处理</text></switch></g></g></g></g><g data-cell-id="sn_r12"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r12_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2250" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2250 M 60 2250 M 60 2290 M 0 2290" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2270px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">12</div></div></div></foreignObject><text x="30" y="2275" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">12</text></switch></g></g></g><g data-cell-id="sn_r12_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2250" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2250 M 1270 2250 M 1270 2290 M 60 2290" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2270px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MailBoxComponent按MailBoxType通过Invoke分发：OrderedMessage保序处理 / GateSession转发等，调用MessageDispatcher.Handle()</div></div></div></foreignObject><text x="62" y="2275" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">MailBoxComponent按MailBoxType通过Invoke分发：OrderedMessage保序处理 / GateSession转发等，调用MessageDispatcher.Handle()</text></switch></g></g></g></g><g data-cell-id="sn_r13"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r13_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2290" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2290 M 60 2290 M 60 2330 M 0 2330" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2310px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">13</div></div></div></foreignObject><text x="30" y="2315" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">13</text></switch></g></g></g><g data-cell-id="sn_r13_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2290" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2290 M 1270 2290 M 1270 2330 M 60 2330" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2310px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">MessageDispatcher → MessageHandler.Run()在<span style="background-color: light-dark(rgb(0, 204, 0), rgb(0, 162, 0));">Map Fiber</span>上执行业务逻辑（如移动、战斗等游戏逻辑）</div></div></div></foreignObject><text x="62" y="2315" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">MessageDispatcher → MessageHandler.Run()在Map Fiber上执行业务逻辑（如移动、战斗等游戏逻辑）</text></switch></g></g></g></g><g data-cell-id="sn_r14"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r14_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2330" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2330 M 60 2330 M 60 2370 M 0 2370" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2350px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">14</div></div></div></foreignObject><text x="30" y="2355" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">14</text></switch></g></g></g><g data-cell-id="sn_r14_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2330" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2330 M 1270 2330 M 1270 2370 M 60 2370" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2350px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">处理完毕，Reply()将Response经Map的ProcessInnerSender → MessageQueue → Gate的ProcessInnerSender原路返回</div></div></div></foreignObject><text x="62" y="2355" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">处理完毕，Reply()将Response经Map的ProcessInnerSender → MessageQueue → Gate的ProcessInnerSender原路返回</text></switch></g></g></g></g><g data-cell-id="sn_r15"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r15_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2370" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2370 M 60 2370 M 60 2410 M 0 2410" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2390px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">15</div></div></div></foreignObject><text x="30" y="2395" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">15</text></switch></g></g></g><g data-cell-id="sn_r15_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2370" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2370 M 1270 2370 M 1270 2410 M 60 2410" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2390px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">Gate收到Response后，HandleIActorResponse匹配内部RpcId，设置ETTask完成，await返回IResponse</div></div></div></foreignObject><text x="62" y="2395" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">Gate收到Response后，HandleIActorResponse匹配内部RpcId，设置ETTask完成，await返回IResponse</text></switch></g></g></g></g><g data-cell-id="sn_r16"><g transform="translate(0.5,0.5)"/><g data-cell-id="sn_r16_n"><g transform="translate(0.5,0.5)"><rect x="0" y="2410" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2410 M 60 2410 M 60 2450 M 0 2450" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2430px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">16</div></div></div></foreignObject><text x="30" y="2435" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">16</text></switch></g></g></g><g data-cell-id="sn_r16_d"><g transform="translate(0.5,0.5)"><rect x="60" y="2410" width="1210" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2410 M 1270 2410 M 1270 2450 M 60 2450" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1208px; height: 1px; padding-top: 2430px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><font color="#CC0000" style="color: light-dark(rgb(204, 0, 0), rgb(255, 163, 163));">Gate恢复客户端原始RpcId写入Response</font>，调用session.Send(iResponse)经KCP回复客户端</div></div></div></foreignObject><text x="62" y="2435" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">Gate恢复客户端原始RpcId写入Response，调用session.Send(iResponse)经KCP回复客户端</text></switch></g></g></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-3"><g transform="translate(0.5,0.5)"><rect x="0" y="2530" width="1020" height="240" fill="#ffffff" stroke="none" pointer-events="none" style="fill: light-dark(#ffffff, var(--ge-dark-color, #121212));"/><path d="M 0 2530 L 1020 2530 L 1020 2770 L 0 2770 L 0 2530" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2570 L 60 2570 L 1020 2570" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2610 L 60 2610 L 1020 2610" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2650 L 60 2650 L 1020 2650" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2690 L 60 2690 L 1020 2690" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 0 2730 L 60 2730 L 1020 2730" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/><path d="M 60 2530 L 60 2570 L 60 2610 L 60 2650 L 60 2690 L 60 2730 L 60 2770" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-4"><g transform="translate(0.5,0.5)"/><g data-cell-id="LnJcN-0OFBurzp4TWZd0-5"><g transform="translate(0.5,0.5)"><rect x="0" y="2530" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2530 M 60 2530 M 60 2570 M 0 2570" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2550px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">1</div></div></div></foreignObject><text x="30" y="2555" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">1</text></switch></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-6"><g transform="translate(0.5,0.5)"><rect x="60" y="2530" width="960" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2530 M 1020 2530 M 1020 2570 M 60 2570" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 958px; height: 1px; padding-top: 2550px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="text-wrap-mode: nowrap;">ISessionMessage</b><span style="text-wrap-mode: nowrap;">: Gate 直接处理并回复的请求（不经过其他 Fiber），如 C2G_LoginGate</span></div></div></div></foreignObject><text x="62" y="2555" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">ISessionMessage: Gate 直接处理并回复的请求（不经过其他 Fiber），如 C2G_LoginGate</text></switch></g></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-8"><g transform="translate(0.5,0.5)"/><g data-cell-id="LnJcN-0OFBurzp4TWZd0-9"><g transform="translate(0.5,0.5)"><rect x="0" y="2570" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2570 M 60 2570 M 60 2610 M 0 2610" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2590px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">2</div></div></div></foreignObject><text x="30" y="2595" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">2</text></switch></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-10"><g transform="translate(0.5,0.5)"><rect x="60" y="2570" width="960" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2570 M 1020 2570 M 1020 2610 M 60 2610" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 958px; height: 1px; padding-top: 2590px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="text-wrap-mode: nowrap;">ILocationRequest</b><span style="text-wrap-mode: nowrap;">: 需转发到目标 Fiber（如 Map）处理的请求，通过 Location 系统路由</span></div></div></div></foreignObject><text x="62" y="2595" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">ILocationRequest: 需转发到目标 Fiber（如 Map）处理的请求，通过 Location 系统路由</text></switch></g></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-12"><g transform="translate(0.5,0.5)"/><g data-cell-id="LnJcN-0OFBurzp4TWZd0-13"><g transform="translate(0.5,0.5)"><rect x="0" y="2610" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2610 M 60 2610 M 60 2650 M 0 2650" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2630px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">3</div></div></div></foreignObject><text x="30" y="2635" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">3</text></switch></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-14"><g transform="translate(0.5,0.5)"><rect x="60" y="2610" width="960" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2610 M 1020 2610 M 1020 2650 M 60 2650" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 958px; height: 1px; padding-top: 2630px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="text-wrap-mode: nowrap;">MessageQueue</b><span style="text-wrap-mode: nowrap;">: 线程安全的 ConcurrentQueue，同进程跨 Fiber 消息传递</span></div></div></div></foreignObject><text x="62" y="2635" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">MessageQueue: 线程安全的 ConcurrentQueue，同进程跨 Fiber 消息传递</text></switch></g></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-16"><g transform="translate(0.5,0.5)"/><g data-cell-id="LnJcN-0OFBurzp4TWZd0-17"><g transform="translate(0.5,0.5)"><rect x="0" y="2650" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2650 M 60 2650 M 60 2690 M 0 2690" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2670px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">4</div></div></div></foreignObject><text x="30" y="2675" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">4</text></switch></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-18"><g transform="translate(0.5,0.5)"><rect x="60" y="2650" width="960" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2650 M 1020 2650 M 1020 2690 M 60 2690" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 958px; height: 1px; padding-top: 2670px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="text-wrap-mode: nowrap;">ProcessInnerSender</b><span style="text-wrap-mode: nowrap;">: 每个 Fiber 都有，负责同进程 Fiber 间消息投递（SendInner）和接收（HandleMessage）</span></div></div></div></foreignObject><text x="62" y="2675" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">ProcessInnerSender: 每个 Fiber 都有，负责同进程 Fiber 间消息投递（SendInner）和接收（HandleMessage）</text></switch></g></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-24"><g transform="translate(0.5,0.5)"/><g data-cell-id="LnJcN-0OFBurzp4TWZd0-25"><g transform="translate(0.5,0.5)"><rect x="0" y="2690" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2690 M 60 2690 M 60 2730 M 0 2730" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2710px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">5</div></div></div></foreignObject><text x="30" y="2715" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">5</text></switch></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-26"><g transform="translate(0.5,0.5)"><rect x="60" y="2690" width="960" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2690 M 1020 2690 M 1020 2730 M 60 2730" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 958px; height: 1px; padding-top: 2710px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="text-wrap-mode: nowrap;">MailBoxComponent</b><span style="text-wrap-mode: nowrap;">: Actor 信箱，收到消息后按 MailBoxType 分发（OrderedMessage / GateSession 等）</span></div></div></div></foreignObject><text x="62" y="2715" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">MailBoxComponent: Actor 信箱，收到消息后按 MailBoxType 分发（OrderedMessage / GateSession 等）</text></switch></g></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-20"><g transform="translate(0.5,0.5)"/><g data-cell-id="LnJcN-0OFBurzp4TWZd0-21"><g transform="translate(0.5,0.5)"><rect x="0" y="2730" width="60" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 0 2730 M 60 2730 M 60 2770 M 0 2770" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 2750px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0; text-align: center; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; ">6</div></div></div></foreignObject><text x="30" y="2755" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px" text-anchor="middle">6</text></switch></g></g></g><g data-cell-id="LnJcN-0OFBurzp4TWZd0-22"><g transform="translate(0.5,0.5)"><rect x="60" y="2730" width="960" height="40" fill="none" stroke="none" pointer-events="all"/><path d="M 60 2730 M 1020 2730 M 1020 2770 M 60 2770" fill="none" stroke="#000000" stroke-linecap="square" stroke-miterlimit="10" pointer-events="all" style="stroke: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));"/></g><g><g><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 958px; height: 1px; padding-top: 2750px; margin-left: 62px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; max-height: 36px; overflow: hidden; color: #000000; "><div style="display: inline-block; font-size: 16px; font-family: Helvetica; color: light-dark(#000000, #ffffff); line-height: 1.2; pointer-events: all; white-space: normal; word-wrap: normal; "><b style="text-wrap-mode: nowrap;">RpcId 流转</b><span style="text-wrap-mode: nowrap;">: Gate 保存客户端 rpcId → 转发时使用内部 rpcId → Map 返回时带内部 rpcId → Gate 恢复客户端 rpcId</span></div></div></div></foreignObject><text x="62" y="2755" fill="light-dark(#000000, #ffffff)" font-family="Helvetica" font-size="16px">RpcId 流转: Gate 保存客户端 rpcId → 转发时使用内部 rpcId → Map 返回时带内部 rpcId → Gate 恢复客户端 rpcId</text></switch></g></g></g></g></g></g></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.drawio.com/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>